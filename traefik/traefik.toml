#zf190417.1137

#---------------------------------------------------------
# Configuration file
#---------------------------------------------------------
[file]
    filename = "/etc/traefik/traefik.toml"
    watch = true



#---------------------------------------------------------
# Access log
#---------------------------------------------------------
filePath = "/var/log/traefik/access.log"
format = "common"



#---------------------------------------------------------
# Service logs (here debug mode)
#---------------------------------------------------------
logLevel = "DEBUG"

[traefikLog]
    filePath = "/var/log/traefik/traefik.log"



#---------------------------------------------------------
# Entrypoints
#---------------------------------------------------------
[entryPoints]
    [entryPoints.http]
    address = ":80"

    [entryPoints.dash]
    address = ":8080"
        [entryPoints.dash.auth]
            [entryPoints.dash.auth.basic]
            usersFile = "/etc/traefik/.htpasswd"



#---------------------------------------------------------
# Admin dashboard
#---------------------------------------------------------
[api]
    entryPoint = "dash"
    dashboard = true



#---------------------------------------------------------
# Backends rules
#---------------------------------------------------------
[backends]
    #-----------------------------------------------------
    # Dashboard traefik
    #-----------------------------------------------------
    [backends.backend_dash]
        [backends.backend_dash.servers.server0]
        url = "http://163.172.131.215:8080"


    #-----------------------------------------------------
    # Site0
    #-----------------------------------------------------
    [backends.backend0]
        [backends.backend0.servers.server0]
#        url = "http://z.zufferey.com"
        url = "http://163.172.131.215:8000"


    #-----------------------------------------------------
    # Site1
    #-----------------------------------------------------
    [backends.backend1]
        [backends.backend1.servers.server0]
        url = "http://163.172.131.215:8001"


    #-----------------------------------------------------
    # Site2
    #-----------------------------------------------------
    [backends.backend2]
        [backends.backend2.servers.server0]
        url = "http://163.172.131.215:8002"


    #-----------------------------------------------------
    # Site3
    #-----------------------------------------------------
    [backends.backend3]
        [backends.backend3.servers.server0]
        url = "http://163.172.131.215:8003"


#---------------------------------------------------------
# Frontends rules
#---------------------------------------------------------
[frontends]
    #-----------------------------------------------------
    # Dashboard traefik redirection
    #-----------------------------------------------------
    [frontends.frontend_dash]
    entryPoints = ["http", "https"]
    backend = "backend_dash"
        [frontends.frontend_dash.routes.route0]
        rule = "Host:traefik.makerspace-lausanne.ch"


    #-----------------------------------------------------
    # Site0 redirection
    #-----------------------------------------------------
    [frontends.frontend0]
    entryPoints = ["http", "https"]
    backend = "backend0"
    passHostHeader = true
        [frontends.frontend0.routes.route0]
        rule = "Host:www.makerspace-lausanne.ch"

    [frontends.frontend0_1]
    entryPoints = ["http", "https"]
    backend = "backend0"
    passHostHeader = true
        [frontends.frontend0_1.routes.route0]
        rule = "Host:www.makerspace-renens.ch"

    [frontends.frontend0_2]
    entryPoints = ["http", "https"]
    backend = "backend0"
    passHostHeader = true
        [frontends.frontend0_2.routes.route0]
        rule = "Host:www.maker-evolution.ch"


    #-----------------------------------------------------
    # Site1 redirection
    #-----------------------------------------------------
    [frontends.frontend1]
    entryPoints = ["http", "https"]
    backend = "backend1"
    passHostHeader = true
        [frontends.frontend1.routes.route0]
        rule = "Host:www1.makerspace-lausanne.ch"


    #-----------------------------------------------------
    # Site2 redirection
    #-----------------------------------------------------
    [frontends.frontend2]
    entryPoints = ["http", "https"]
    backend = "backend2"
    passHostHeader = true
        [frontends.frontend2.routes.route0]
        rule = "Host:www2.makerspace-lausanne.ch"


    #-----------------------------------------------------
    # Site3 redirection
    #-----------------------------------------------------
    [frontends.frontend3]
    entryPoints = ["http", "https"]
    backend = "backend3"
    passHostHeader = true
        [frontends.frontend3.auth.basic]
        usersfile = "/etc/traefik/.htpasswd"

        [frontends.frontend3.routes.route0]
        rule = "Host:www3.makerspace-lausanne.ch"

